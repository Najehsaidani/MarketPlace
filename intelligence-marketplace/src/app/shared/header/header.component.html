<header class="main-header">
  <div class="top-row">
    <div class="logo">
      <a routerLink="/" class="logo-link">
        <img src="../../../assets/logo.svg" alt="Intelligent Marketplace Logo" class="logo-img">
      </a>
    </div>

    <div class="user-actions">
      <div class="icon-link notification" (click)="toggleNotifications()">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px">
          <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/>
        </svg>
        <span class="notification-badge" *ngIf="getUnreadCount() > 0">{{ getUnreadCount() }}</span>
      </div>
      <div class="profile-dropdown">
        <div class="profile-icon icon-link" (click)="toggleProfileMenu()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px">
            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
          </svg>
        </div>
        <div class="dropdown-menu" [class.show]="isProfileMenuOpen">
          <a routerLink="/profile" class="dropdown-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
            </svg>
            Mon Profil
          </a>
          <a routerLink="/profile" [queryParams]="{tab: 'orders'}" class="dropdown-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M0 2.5A.5.5 0 0 1 .5 2H2a.5.5 0 0 1 .485.379L2.89 4H14.5a.5.5 0 0 1 .485.621l-1.5 6A.5.5 0 0 1 13 11H4a.5.5 0 0 1-.485-.379L1.61 3H.5a.5.5 0 0 1-.5-.5zM3.14 5l.5 2H5V5H3.14zM6 5v2h2V5H6zm3 0v2h2V5H9zm3 0v2h1.36l.5-2H12zm1.11 3H12v2h.61l.5-2zM11 8H9v2h2V8zM8 8H6v2h2V8zM5 8H3.89l.5 2H5V8zm0 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0zm9-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0z"/>
            </svg>
            Historique des Commandes
          </a>
          <a routerLink="/profile" [queryParams]="{tab: 'payments'}" class="dropdown-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M4 10.781c.148 1.667 1.513 2.85 3.087 3.22.524.124 1.054.167 1.584.167.53 0 1.06-.043 1.584-.167 1.574-.37 2.939-1.553 3.087-3.22.148-1.667-.5-3.125-1.781-4.305l-.02-.018C10.587 4.31 9.34 3.5 8 3.5c-1.34 0-2.587.81-3.207 2.007l-.02.018C3.5 6.662 2.852 8.12 3 9.781z"/>
              <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
            </svg>
            Historique des Paiements
          </a>
        </div>
      </div>
      <a routerLink="/panier" class="icon-link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px"><path d="M0 0h24v24H0z" fill="none"/><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 3h2l3.6 7.59-1.35 2.44C4.84 14.22 5.91 16 7.5 16H18c.83 0 1.5-.67 1.5-1.5S18.83 13 18 13H7.5l.75-1.5L20 9.49V3H4zM20 18c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/></svg>
        <span class="cart-count">3</span>
      </a>
    </div>
  </div>

  <nav class="main-nav">
    <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="nav-link">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
        <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5Z"/>
        <path d="M13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"/>
      </svg>
      Accueil
    </a>
    <a routerLink="/catalogue" routerLinkActive="active" class="nav-link">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
      </svg>
      Catalogue
    </a>
    <!-- Removed chat link as requested -->
    <a routerLink="/top-sellers" routerLinkActive="active" class="nav-link">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
        <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2zM8 1.918l-.797.161A4.002 4.002 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4.002 4.002 0 0 0-3.203-3.92L8 1.917zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5.002 5.002 0 0 1 13 6c0 .88.32 4.2 1.22 6z"/>
      </svg>
      Top Vendeurs
    </a>
    <a routerLink="/become-seller" routerLinkActive="active" class="nav-link">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
        <path d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zm.5 2.5a.5.5 0 0 0-1 0v2a.5.5 0 0 0 1 0v-2zm3 0a.5.5 0 0 0-1 0v2a.5.5 0 0 0 1 0v-2zm3 0a.5.5 0 0 0-1 0v2a.5.5 0 0 0 1 0v-2zm-6 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5.5zm0 2a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5.5zm0 2a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5.5z"/>
      </svg>
      Devenir Vendeur
    </a>
    <a routerLink="/contact" routerLinkActive="active" class="nav-link">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
        <path d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zm.5 2.5a.5.5 0 0 0-1 0v2a.5.5 0 0 0 1 0v-2zm3 0a.5.5 0 0 0-1 0v2a.5.5 0 0 0 1 0v-2zm3 0a.5.5 0 0 0-1 0v2a.5.5 0 0 0 1 0v-2zm-6 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5.5zm0 2a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5.5zm0 2a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5.5z"/>
      </svg>
      Contact
    </a>
  </nav>

  <!-- Notification Popup -->
  <div class="notification-popup" *ngIf="isNotificationsOpen">
    <div class="popup-content">
      <div class="popup-header">
        <h3>Notifications</h3>
        <button class="close-btn" (click)="toggleNotifications()">×</button>
      </div>
      <div class="popup-body">
        <div class="notification-list" *ngIf="notifications.length > 0; else noNotifications">
          <div
            *ngFor="let notification of notifications"
            class="notification-item"
            [ngClass]="['notification-' + notification.type, notification.read ? 'read' : 'unread']"
            (click)="markAsRead(notification.id)"
          >
            <div class="notification-content">
              <div class="notification-message">{{ notification.message }}</div>
              <div class="notification-time">{{ notification.timestamp | date:'short' }}</div>
              <button
                class="close-btn-small"
                (click)="removeNotification(notification.id); $event.stopPropagation();"
                aria-label="Fermer la notification"
              >
                ×
              </button>
            </div>
          </div>
        </div>
        <ng-template #noNotifications>
          <p class="no-notifications">Vous n'avez aucune notification</p>
        </ng-template>
        <div class="notification-footer" *ngIf="notifications.length > 0">
          <button class="clear-all-btn" (click)="markAllAsRead()">Tout marquer comme lu</button>
          <button class="clear-all-btn" (click)="clearAll()">Tout effacer</button>
        </div>
      </div>
    </div>
  </div>
</header>
